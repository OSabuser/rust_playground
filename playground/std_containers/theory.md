# Стандартные коллекции RUST

> [Официальная документация](https://doc.rust-lang.org/std/collections/)

Находятся в модуле `std::collections`  

- Последовательности: `Vec, VecDeque, LinkedList`

    Эффективное добавление элемента в начало и конец, итерирование + известен порядок элементов.

- Словари: `HashMap, BTreeMap, HashSet, BTreeSet`

    Эффективное чтение по ключу

- Множества: `HashSet, BTreeSet`

- Прочее: `BinaryHeap`

## Общий интерфейс

1. `new()` - создает пустую коллекцию, без выделения памяти
2. `with_capacity(n: size) -> Self` - аллокация под ожидаемое кол-во элементов заранее
3. `len(&self) -> usize`
4. `is_empty(&self) -> bool`
5. `clear(&mut self)` - удаляет элементы (len = 0), capacity не изменяется!
6. `get(), get_mut()` `-> Option<&V>, Option<&mut V>`

### Vec

- Динамический массив с быстрой вставкой в конец `O(1)`
- Может работать как стек, `push(&mut self, T), pop(&mut self) -> Option<T>`
- `insert(&mut self, index: usize, element: T)` - вставляет элемент в определенную позицию `O(n)`
- `remove(&mut self, index: usize) -> T` - удаляет элемент по индексу `O(n)`
- `swap_remove(&mut self, index: usize)` - удаление по индексу, в случае если порядок элементов неважен
- `sort(&mut self), sort_unstable(&mut self)` - `stable` - не меняет порядок равных элементов, но медленнее `unstable`
- vec![] - макрос для быстрого конструирования вектора
- Реализует `Deref<Target = [T]>`

```rust
// Структура Vec (размещается на стеке)
struct Vec<T> {
    ptr: NonNull<T>, // Указатель на первый элемент в куче
    len: usize, // Количество элементов 
    capacity: usize, // Размер выделенной памяти
}
```

> Если при добавлении элемента в вектор превышается велчина `capacity`, происходит реалокация вектора.
Создаётся большая область памяти, в которую копируются содержимое вектора. Старая область памяти деалоцируется.

### VecDeque

- Динамический массив с быстрой вставкой в начало и конец
- `push_back(&mut self, T)`
- `push_front(&mut self, T)`
- `pop_back(&mut self) -> Option<T>`
- `pop_front(&mut self) -> Option<T>`
- `make_contigious(&mut self)` - хранение вектора в одной непрерывной области памяти (для преобразования в слайс)

#### String

- По сути `Vec<u8>`
- Внутри обязательно корректный `UTF-8`
- `len()` - возвращает количество байт, а не символов строки!
- Нет доступа к конкретному байту, но есть доступ к последовательности байт `[0..3]`
- push_str(&mut self, s: &str) - конкатенация строки

    ```rust
    // Второй способ конкатенации строк
    let s1 = String::from("Hello");
    let s2 = String::from("World!");
    let s3 = s1 + &s2;
    // !! `s1` больше использовать нельзя!
    ```
